{"ast":null,"code":"import { Action } from \"../../internal/Action.js\";\nimport { Transformation } from \"../../transformation/Transformation.js\";\n/**\n * @description Class for Concatenating another video.\n *\n * <b>Learn more</b>: {@link https://cloudinary.com/documentation/video_manipulation_and_delivery#concatenating_videos|Concatenating videos}\n * @extends SDK.Action\n * @memberOf Actions.VideoEdit\n * @see Visit {@link Actions.VideoEdit|VideoEdit} for an example\n */\n\nclass ConcatenateAction extends Action {\n  /**\n   *\n   * @param {Qualifiers.Source.VideoSource | Qualifiers.Source.ImageSource | Qualifiers.Source.FetchSource} source\n   *         the Source to concatenate\n   */\n  constructor(source) {\n    super();\n    this.concatSource = source;\n  }\n  /**\n   * @description Sets the transition between a video and a concatenated source\n   * @param {Qualifiers.Transition.VideoSource} source The source to concatenate.\n   * @return {this}\n   */\n\n\n  transition(source) {\n    this._transition = source;\n    return this;\n  }\n  /**\n   * @description Prepend the concatenated video - Adds the video before the original\n   * @return {this}\n   */\n\n\n  prepend() {\n    this._prepend = true;\n    return this;\n  }\n  /**\n   * The duration in seconds\n   * @param {number} sec\n   * @return {this}\n   */\n\n\n  duration(sec) {\n    this._duration = sec;\n    return this;\n  }\n  /**\n   * @description Get the transitionString for the toString() method\n   * @return {string}\n   */\n\n\n  getTransitionString() {\n    const transTx = this._transition.getTransformation();\n\n    return [`e_transition,${this._transition.getOpenSourceString('l')}`, transTx && transTx.toString(), 'fl_layer_apply'].filter(a => a).join('/');\n  }\n  /**\n   * @description Get the string representation of the Concatenation action\n   */\n\n\n  toString() {\n    /*\n     *\n     * The toString() method is composed of several steps due to the complex nature of the concatenate transformation.\n     *\n     * First, we calculate the open and close parts of the top-level transformation:\n     *   - {open}/{sourceTransformation}/{close}\n     *\n     * Unlike a regular overlay, there are multiple 'bits' appended to the open and close parts of the tx.\n     * - duration (du_) might be prepended on the opening of the layer (du_5,l_sample)\n     * - fl_splice is also added, but only if a transition is not needed.\n     *\n     * once we've calculated the open and close parts, we now need to deal with the Transition.\n     * the transition is an inner transformation on the source with a special effect (e_transition) appended to it.\n     *\n     * To calculate the transition string, we need to take the transformation from the source(assuming it has one)\n     */\n    // Calculate the open part\n    const open = [this._duration && `du_${this._duration}`, !this._transition && `fl_splice`, `${this.concatSource.getOpenSourceString('l')}`].filter(a => a).join(','); // Calculate the open part\n\n    const close = ['fl_layer_apply', this._prepend && 'so_0'].filter(a => a).join(','); // Calculate the Transition part\n\n    let concatSourceTx;\n\n    if (this.concatSource.getTransformation()) {\n      concatSourceTx = this.concatSource.getTransformation();\n    } else {\n      concatSourceTx = new Transformation();\n    }\n\n    if (this._transition) {\n      concatSourceTx.addTransformation(this.getTransitionString());\n    } // Put it all together, the transition is already part of the concatSourceTx\n\n\n    return [open, concatSourceTx.toString(), close].filter(a => a).join('/');\n  }\n\n}\n\nexport default ConcatenateAction;","map":null,"metadata":{},"sourceType":"module"}