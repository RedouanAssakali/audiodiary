{"ast":null,"code":"import { QualifierValue } from \"../../internal/qualifier/QualifierValue.js\";\nimport { Qualifier } from \"../../internal/qualifier/Qualifier.js\";\nimport { DeliveryAction } from \"./DeliveryAction.js\";\nimport { CHROMA_VALUE_TO_CHROMA_MODEL_ENUM, CHROMA_MODEL_ENUM_TO_CHROMA_VALUE, ACTION_TYPE_TO_QUALITY_MODE_MAP } from \"../../internal/internalConstants.js\";\n/**\n * @description Controls the quality of the delivered image or video.\n * @memberOf Actions.Delivery\n * @extends {Actions.Delivery.DeliveryAction}\n * @see Visit {@link Actions.Delivery|Delivery} for an example\n */\n\nclass DeliveryQualityAction extends DeliveryAction {\n  /**\n   * @param {Qualifiers.Quality} qualityValue a Quality value\n   */\n  constructor(qualityValue) {\n    super('q', qualityValue.toString(), 'level');\n  }\n  /**\n   * Selet the Chroma sub sampling</br>\n   * <b>Learn more</b>: {@link https://cloudinary.com/documentation/image_transformations#toggling_chroma_subsampling|Toggling chroma subsampling}\n   * @param {420 | 444 | number} type The chroma sub sampling type\n   */\n\n\n  chromaSubSampling(type) {\n    this._actionModel.chromaSubSampling = CHROMA_VALUE_TO_CHROMA_MODEL_ENUM[type];\n    const qualityWithSubSampling = new QualifierValue([this._actionModel.level, type]);\n    qualityWithSubSampling.setDelimiter(':'); // We either have chroma or quantization, but not both\n\n    return this.addQualifier(new Qualifier('q', qualityWithSubSampling));\n  }\n  /**\n   * Controls the final quality by setting a maximum quantization percentage\n   * @param {number} val\n   */\n\n\n  quantization(val) {\n    this._actionModel.quantization = val;\n    const qualityWithQuantization = new QualifierValue([this._actionModel.level, `qmax_${val}`]).setDelimiter(':'); // We either have chroma or quantization, but not both\n\n    return this.addQualifier(new Qualifier('q', qualityWithQuantization));\n  }\n\n  static fromJson(actionModel) {\n    const {\n      level,\n      chromaSubSampling,\n      quantization\n    } = actionModel;\n    const levelType = ACTION_TYPE_TO_QUALITY_MODE_MAP[level] || level;\n    const result = new this(levelType);\n\n    if (chromaSubSampling) {\n      //Turn strings like 'CHROMA_420' to 420\n      const chromaValue = CHROMA_MODEL_ENUM_TO_CHROMA_VALUE[chromaSubSampling.toUpperCase()];\n      chromaValue && result.chromaSubSampling(+chromaValue);\n    }\n\n    quantization && result.quantization(quantization);\n    return result;\n  }\n\n}\n\nexport { DeliveryQualityAction };","map":null,"metadata":{},"sourceType":"module"}